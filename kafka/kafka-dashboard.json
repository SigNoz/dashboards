{
  "description": "Kafka server monitoring dashboard using OpenTelemetry kafkametricsreceiver metrics.",
  "layout": [
    {
      "h": 1,
      "i": "91dda66a-499a-48a9-be39-dc47b90d4529",
      "maxH": 1,
      "minH": 1,
      "minW": 12,
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 0
    },
    {
      "h": 1,
      "i": "6eae1cff-5de2-41ee-8832-9e13b41468c1",
      "maxH": 1,
      "minH": 1,
      "minW": 12,
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 13
    },
    {
      "h": 1,
      "i": "8ee21474-b6e0-409b-8c23-56c0a2165216",
      "maxH": 1,
      "minH": 1,
      "minW": 12,
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 26
    },
    {
      "h": 1,
      "i": "5dfabfcb-aa01-440f-811e-55db50c5d679",
      "maxH": 1,
      "minH": 1,
      "minW": 12,
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 39
    }
  ],
  "panelMap": {
    "91dda66a-499a-48a9-be39-dc47b90d4529": {
      "collapsed": true,
      "widgets": [
        {
          "h": 6,
          "i": "b22506a6-3f84-48df-a73e-938e5bff4821",
          "moved": false,
          "static": false,
          "w": 6,
          "x": 0,
          "y": 1
        },
        {
          "h": 6,
          "i": "09704a1a-d1aa-44e7-9f3d-0237c7ee552a",
          "moved": false,
          "static": false,
          "w": 6,
          "x": 6,
          "y": 1
        }
      ]
    },
    "6eae1cff-5de2-41ee-8832-9e13b41468c1": {
      "collapsed": true,
      "widgets": [
        {
          "h": 6,
          "i": "a37c8019-6d8e-466f-b604-7cf3851c37bd",
          "moved": false,
          "static": false,
          "w": 6,
          "x": 0,
          "y": 14
        },
        {
          "h": 6,
          "i": "5b492e57-5ee9-475e-9518-e1e092c1667d",
          "moved": false,
          "static": false,
          "w": 6,
          "x": 6,
          "y": 14
        },
        {
          "h": 6,
          "i": "f8b49d13-dcca-4ef3-8d57-8d3d44fbbb4d",
          "moved": false,
          "static": false,
          "w": 6,
          "x": 0,
          "y": 20
        },
        {
          "h": 6,
          "i": "b0e187aa-b0c3-45e8-8f44-bd9bfa5d85ef",
          "moved": false,
          "static": false,
          "w": 6,
          "x": 6,
          "y": 20
        }
      ]
    },
    "8ee21474-b6e0-409b-8c23-56c0a2165216": {
      "collapsed": true,
      "widgets": [
        {
          "h": 6,
          "i": "72dafaca-a878-4475-8072-beda329fc63b",
          "moved": false,
          "static": false,
          "w": 6,
          "x": 0,
          "y": 27
        },
        {
          "h": 6,
          "i": "9ab81fd9-cdfd-4fbc-926c-9cd1727ea745",
          "moved": false,
          "static": false,
          "w": 6,
          "x": 6,
          "y": 27
        }
      ]
    },
    "5dfabfcb-aa01-440f-811e-55db50c5d679": {
      "collapsed": true,
      "widgets": [
        {
          "h": 6,
          "i": "f9a00bb9-6f43-4208-9c6f-07c8245a679f",
          "moved": false,
          "static": false,
          "w": 6,
          "x": 0,
          "y": 40
        },
        {
          "h": 6,
          "i": "5384906e-2472-47bb-b658-388675244427",
          "moved": false,
          "static": false,
          "w": 6,
          "x": 6,
          "y": 40
        },
        {
          "h": 6,
          "i": "7d7dc73d-5b6a-4ff2-b655-70bf64769e51",
          "moved": false,
          "static": false,
          "w": 6,
          "x": 0,
          "y": 46
        },
        {
          "h": 6,
          "i": "6cb0a4fa-0aad-4a09-9e58-a8b411aabbf9",
          "moved": false,
          "static": false,
          "w": 6,
          "x": 6,
          "y": 46
        }
      ]
    }
  },
  "tags": [
    "kafka",
    "otel"
  ],
  "title": "Kafka Server Monitoring Dashboard",
  "uploadedGrafana": false,
  "variables": {
    "b93b38c6-9f1a-481a-81bb-df9cdcae5c91": {
      "allSelected": false,
      "customValue": "",
      "description": "",
      "id": "b93b38c6-9f1a-481a-81bb-df9cdcae5c91",
      "modificationUUID": "ab34dfee-7f77-46ad-a501-1b392681fb6e",
      "multiSelect": false,
      "name": "deployment.environment",
      "order": 0,
      "queryValue": "SELECT JSONExtractString(labels, 'deployment.environment') AS `deployment.environment`\nFROM signoz_metrics.distributed_time_series_v4_1day\nWHERE metric_name = 'kafka.brokers'\nGROUP BY `deployment.environment`\n",
      "selectedValue": "",
      "showALLOption": false,
      "sort": "ASC",
      "textboxValue": "",
      "type": "QUERY"
    },
    "785a2338-82cd-4abb-887e-f2c56c8266c0": {
      "allSelected": false,
      "customValue": "",
      "description": "",
      "id": "785a2338-82cd-4abb-887e-f2c56c8266c0",
      "modificationUUID": "582687f0-5f30-4241-a84e-f4d444397f5d",
      "multiSelect": false,
      "name": "kafka.cluster.alias",
      "order": 1,
      "queryValue": "SELECT JSONExtractString(labels, 'kafka.cluster.alias') AS `kafka.cluster.alias`\nFROM signoz_metrics.distributed_time_series_v4_1day\nWHERE metric_name = 'kafka.brokers'\n  AND JSONExtractString(labels, 'deployment.environment') = '{{.deployment.environment}}'\nGROUP BY `kafka.cluster.alias`\n",
      "selectedValue": "",
      "showALLOption": false,
      "sort": "ASC",
      "textboxValue": "",
      "type": "QUERY"
    }
  },
  "version": "v4",
  "widgets": [
    {
      "description": "",
      "id": "91dda66a-499a-48a9-be39-dc47b90d4529",
      "panelTypes": "row",
      "title": "Broker Metrics"
    },
    {
      "description": "",
      "id": "6eae1cff-5de2-41ee-8832-9e13b41468c1",
      "panelTypes": "row",
      "title": "Consumer Metrics"
    },
    {
      "description": "",
      "id": "8ee21474-b6e0-409b-8c23-56c0a2165216",
      "panelTypes": "row",
      "title": "Topic Metrics"
    },
    {
      "description": "",
      "id": "5dfabfcb-aa01-440f-811e-55db50c5d679",
      "panelTypes": "row",
      "title": "Partition Metrics"
    },
    {
      "bucketCount": 60,
      "bucketWidth": 0,
      "columnUnits": {},
      "description": "",
      "fillSpans": false,
      "id": "b22506a6-3f84-48df-a73e-938e5bff4821",
      "isStacked": false,
      "mergeAllActiveQueries": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "21b02af9-a772-48bd-b6e3-0afe8cf5bd4e",
        "promql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": "sum(kafka_brokers{deployment_environment=~\"{{.deployment.environment}}\",kafka_cluster_alias=~\"{{.kafka.cluster.alias}}\"})"
          }
        ],
        "queryType": "promql"
      },
      "softMax": 0,
      "softMin": 0,
      "stackedBarChart": false,
      "thresholds": [],
      "timePreferance": "GLOBAL_TIME",
      "title": "kafka.brokers",
      "yAxisUnit": "short"
    },
    {
      "bucketCount": 60,
      "bucketWidth": 0,
      "columnUnits": {},
      "description": "",
      "fillSpans": false,
      "id": "09704a1a-d1aa-44e7-9f3d-0237c7ee552a",
      "isStacked": false,
      "mergeAllActiveQueries": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "f006cb83-3375-4e7d-87c3-57c062d3547d",
        "promql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": "max(kafka_controller_active_controller_count{deployment_environment=~\"{{.deployment.environment}}\",kafka_cluster_alias=~\"{{.kafka.cluster.alias}}\"})"
          }
        ],
        "queryType": "promql"
      },
      "softMax": 0,
      "softMin": 0,
      "stackedBarChart": false,
      "thresholds": [],
      "timePreferance": "GLOBAL_TIME",
      "title": "kafka.controller status",
      "yAxisUnit": "short"
    },
    {
      "bucketCount": 60,
      "bucketWidth": 0,
      "columnUnits": {},
      "description": "",
      "fillSpans": false,
      "id": "a37c8019-6d8e-466f-b604-7cf3851c37bd",
      "isStacked": false,
      "mergeAllActiveQueries": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "b90eaca0-556d-4ccd-ace8-ae78cc4b3561",
        "promql": [
          {
            "disabled": false,
            "legend": "{{group}}/{{topic}}/{{partition}}",
            "name": "A",
            "query": "sum by (group, topic, partition) (kafka_consumer_group_lag{deployment_environment=~\"{{.deployment.environment}}\",kafka_cluster_alias=~\"{{.kafka.cluster.alias}}\"})"
          }
        ],
        "queryType": "promql"
      },
      "softMax": 0,
      "softMin": 0,
      "stackedBarChart": false,
      "thresholds": [],
      "timePreferance": "GLOBAL_TIME",
      "title": "kafka.consumer_group.lag",
      "yAxisUnit": "short"
    },
    {
      "bucketCount": 60,
      "bucketWidth": 0,
      "columnUnits": {},
      "description": "",
      "fillSpans": false,
      "id": "5b492e57-5ee9-475e-9518-e1e092c1667d",
      "isStacked": false,
      "mergeAllActiveQueries": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "267e9239-35f8-4e6e-a7a6-426a73352360",
        "promql": [
          {
            "disabled": false,
            "legend": "{{group}}/{{topic}}",
            "name": "A",
            "query": "sum by (group, topic) (kafka_consumer_group_lag_sum{deployment_environment=~\"{{.deployment.environment}}\",kafka_cluster_alias=~\"{{.kafka.cluster.alias}}\"})"
          }
        ],
        "queryType": "promql"
      },
      "softMax": 0,
      "softMin": 0,
      "stackedBarChart": false,
      "thresholds": [],
      "timePreferance": "GLOBAL_TIME",
      "title": "kafka.consumer_group.lag_sum",
      "yAxisUnit": "short"
    },
    {
      "bucketCount": 60,
      "bucketWidth": 0,
      "columnUnits": {},
      "description": "",
      "fillSpans": false,
      "id": "f8b49d13-dcca-4ef3-8d57-8d3d44fbbb4d",
      "isStacked": false,
      "mergeAllActiveQueries": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "885e2e69-8e80-465d-ad83-6ea0e5bb619c",
        "promql": [
          {
            "disabled": false,
            "legend": "{{group}}",
            "name": "A",
            "query": "sum by (group) (kafka_consumer_group_members{deployment_environment=~\"{{.deployment.environment}}\",kafka_cluster_alias=~\"{{.kafka.cluster.alias}}\"})"
          }
        ],
        "queryType": "promql"
      },
      "softMax": 0,
      "softMin": 0,
      "stackedBarChart": false,
      "thresholds": [],
      "timePreferance": "GLOBAL_TIME",
      "title": "kafka.consumer_group.members",
      "yAxisUnit": "short"
    },
    {
      "bucketCount": 60,
      "bucketWidth": 0,
      "columnUnits": {},
      "description": "",
      "fillSpans": false,
      "id": "b0e187aa-b0c3-45e8-8f44-bd9bfa5d85ef",
      "isStacked": false,
      "mergeAllActiveQueries": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "1a382903-3d58-4565-991b-61fa83044867",
        "promql": [
          {
            "disabled": false,
            "legend": "{{group}}/{{topic}}/{{partition}}",
            "name": "A",
            "query": "sum by (group, topic, partition) (kafka_consumer_group_offset{deployment_environment=~\"{{.deployment.environment}}\",kafka_cluster_alias=~\"{{.kafka.cluster.alias}}\"})"
          }
        ],
        "queryType": "promql"
      },
      "softMax": 0,
      "softMin": 0,
      "stackedBarChart": false,
      "thresholds": [],
      "timePreferance": "GLOBAL_TIME",
      "title": "kafka.consumer_group.offset",
      "yAxisUnit": "short"
    },
    {
      "bucketCount": 60,
      "bucketWidth": 0,
      "columnUnits": {},
      "description": "",
      "fillSpans": false,
      "id": "72dafaca-a878-4475-8072-beda329fc63b",
      "isStacked": false,
      "mergeAllActiveQueries": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "f7d48771-0e1c-40de-ba08-7664b32df456",
        "promql": [
          {
            "disabled": false,
            "legend": "{{topic}}",
            "name": "A",
            "query": "sum by (topic) (kafka_topic_partitions{deployment_environment=~\"{{.deployment.environment}}\",kafka_cluster_alias=~\"{{.kafka.cluster.alias}}\"})"
          }
        ],
        "queryType": "promql"
      },
      "softMax": 0,
      "softMin": 0,
      "stackedBarChart": false,
      "thresholds": [],
      "timePreferance": "GLOBAL_TIME",
      "title": "kafka.topic.partitions",
      "yAxisUnit": "short"
    },
    {
      "bucketCount": 60,
      "bucketWidth": 0,
      "columnUnits": {},
      "description": "",
      "fillSpans": false,
      "id": "9ab81fd9-cdfd-4fbc-926c-9cd1727ea745",
      "isStacked": false,
      "mergeAllActiveQueries": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "21d24032-fe9f-47c6-84e8-9793a6bb8e8a",
        "promql": [
          {
            "disabled": false,
            "legend": "{{topic}}",
            "name": "A",
            "query": "avg by (topic) (kafka_topic_log_retention_period{deployment_environment=~\"{{.deployment.environment}}\",kafka_cluster_alias=~\"{{.kafka.cluster.alias}}\"})"
          }
        ],
        "queryType": "promql"
      },
      "softMax": 0,
      "softMin": 0,
      "stackedBarChart": false,
      "thresholds": [],
      "timePreferance": "GLOBAL_TIME",
      "title": "kafka.topic.log_retention",
      "yAxisUnit": "s"
    },
    {
      "bucketCount": 60,
      "bucketWidth": 0,
      "columnUnits": {},
      "description": "",
      "fillSpans": false,
      "id": "f9a00bb9-6f43-4208-9c6f-07c8245a679f",
      "isStacked": false,
      "mergeAllActiveQueries": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "a2b075e1-f479-4270-b175-60ff0d15f53c",
        "promql": [
          {
            "disabled": false,
            "legend": "{{topic}}/{{partition}}",
            "name": "A",
            "query": "max by (topic, partition) (kafka_partition_current_offset{deployment_environment=~\"{{.deployment.environment}}\",kafka_cluster_alias=~\"{{.kafka.cluster.alias}}\"})"
          }
        ],
        "queryType": "promql"
      },
      "softMax": 0,
      "softMin": 0,
      "stackedBarChart": false,
      "thresholds": [],
      "timePreferance": "GLOBAL_TIME",
      "title": "kafka.partition.current_offset",
      "yAxisUnit": "short"
    },
    {
      "bucketCount": 60,
      "bucketWidth": 0,
      "columnUnits": {},
      "description": "",
      "fillSpans": false,
      "id": "5384906e-2472-47bb-b658-388675244427",
      "isStacked": false,
      "mergeAllActiveQueries": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "d50af977-4f45-42cc-a6dd-a849fa984ea1",
        "promql": [
          {
            "disabled": false,
            "legend": "{{topic}}/{{partition}}",
            "name": "A",
            "query": "max by (topic, partition) (kafka_partition_oldest_offset{deployment_environment=~\"{{.deployment.environment}}\",kafka_cluster_alias=~\"{{.kafka.cluster.alias}}\"})"
          }
        ],
        "queryType": "promql"
      },
      "softMax": 0,
      "softMin": 0,
      "stackedBarChart": false,
      "thresholds": [],
      "timePreferance": "GLOBAL_TIME",
      "title": "kafka.partition.oldest_offset",
      "yAxisUnit": "short"
    },
    {
      "bucketCount": 60,
      "bucketWidth": 0,
      "columnUnits": {},
      "description": "",
      "fillSpans": false,
      "id": "7d7dc73d-5b6a-4ff2-b655-70bf64769e51",
      "isStacked": false,
      "mergeAllActiveQueries": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "962fb426-8393-47eb-8c85-2f80066880e1",
        "promql": [
          {
            "disabled": false,
            "legend": "{{topic}}/{{partition}}",
            "name": "A",
            "query": "sum by (topic, partition) (kafka_partition_replicas{deployment_environment=~\"{{.deployment.environment}}\",kafka_cluster_alias=~\"{{.kafka.cluster.alias}}\"})"
          }
        ],
        "queryType": "promql"
      },
      "softMax": 0,
      "softMin": 0,
      "stackedBarChart": false,
      "thresholds": [],
      "timePreferance": "GLOBAL_TIME",
      "title": "kafka.partition.replicas",
      "yAxisUnit": "short"
    },
    {
      "bucketCount": 60,
      "bucketWidth": 0,
      "columnUnits": {},
      "description": "",
      "fillSpans": false,
      "id": "6cb0a4fa-0aad-4a09-9e58-a8b411aabbf9",
      "isStacked": false,
      "mergeAllActiveQueries": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": false,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "1209b015-c264-4ec5-b04c-aa6097ec9345",
        "promql": [
          {
            "disabled": false,
            "legend": "{{topic}}/{{partition}}",
            "name": "A",
            "query": "sum by (topic, partition) (kafka_partition_replicas_in_sync{deployment_environment=~\"{{.deployment.environment}}\",kafka_cluster_alias=~\"{{.kafka.cluster.alias}}\"})"
          }
        ],
        "queryType": "promql"
      },
      "softMax": 0,
      "softMin": 0,
      "stackedBarChart": false,
      "thresholds": [],
      "timePreferance": "GLOBAL_TIME",
      "title": "kafka.partition.replicas_in_sync",
      "yAxisUnit": "short"
    }
  ]
}
