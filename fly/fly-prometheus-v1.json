{
  "description": "Adapted 1:1 from the official Fly Grafana dashboard queries.",
  "layout": [
    {
      "h": 6,
      "i": "p_data",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 0
    },
    {
      "h": 6,
      "i": "p_load",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 6
    },
    {
      "h": 7,
      "i": "p_mem",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 12
    },
    {
      "h": 7,
      "i": "p_cpu",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 19
    },
    {
      "h": 7,
      "i": "p_tcp_e_c",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 26
    },
    {
      "h": 7,
      "i": "p_tcp_a_c",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 33
    },
    {
      "h": 7,
      "i": "p_tcp_e_d",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 40
    },
    {
      "h": 7,
      "i": "p_tcp_a_d",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 47
    },
    {
      "h": 7,
      "i": "p_http_rps",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 54
    },
    {
      "h": 7,
      "i": "p_http_edge_heat",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 61
    },
    {
      "h": 7,
      "i": "p_http_app_heat",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 68
    },
    {
      "h": 7,
      "i": "p_tls_hs_heat",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 75
    },
    {
      "h": 7,
      "i": "p_tls_hsps",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 82
    },
    {
      "h": 7,
      "i": "p_tls_q_heat",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 89
    },
    {
      "h": 6,
      "i": "p_tls_err",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 96
    },
    {
      "h": 6,
      "i": "p_tls_sni",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 102
    },
    {
      "h": 6,
      "i": "p_tls_ip",
      "moved": false,
      "static": false,
      "w": 12,
      "x": 0,
      "y": 108
    }
  ],
  "panelMap": {},
  "tags": ["fly.io", "prometheus", "federate"],
  "title": "Fly.io â€” Fly App (SigNoz)",
  "uploadedGrafana": false,
  "variables": {},
  "version": "v5",
  "widgets": [
    {
      "id": "p_data",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_data",
        "promql": [
          {
            "disabled": false,
            "legend": "sent",
            "name": "A",
            "query": "sum(rate(fly_instance_net_sent_bytes{device=\"eth0\",app=~\".*\",region=~\".*\",host=~\".*\"}[5m]))"
          },
          {
            "disabled": false,
            "legend": "recv",
            "name": "B",
            "query": "sum(rate(fly_instance_net_recv_bytes{device=\"eth0\",app=~\".*\",region=~\".*\",host=~\".*\"}[5m]))"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "Data Transfer",
      "yAxisUnit": "bytes_per_sec"
    },
    {
      "id": "p_load",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_load",
        "promql": [
          {
            "disabled": false,
            "legend": "1m",
            "name": "A",
            "query": "max(max_over_time(fly_instance_load_average{minutes=\"1\",app=~\".*\",region=~\".*\",host=~\".*\"}[5m]))"
          },
          {
            "disabled": false,
            "legend": "5m",
            "name": "B",
            "query": "max(max_over_time(fly_instance_load_average{minutes=\"5\",app=~\".*\",region=~\".*\",host=~\".*\"}[5m]))"
          },
          {
            "disabled": false,
            "legend": "15m",
            "name": "C",
            "query": "max(max_over_time(fly_instance_load_average{minutes=\"15\",app=~\".*\",region=~\".*\",host=~\".*\"}[5m]))"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "Load Average",
      "yAxisUnit": "none"
    },
    {
      "id": "p_mem",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_mem",
        "promql": [
          {
            "disabled": false,
            "legend": "total",
            "name": "A",
            "query": "avg(fly_instance_memory_mem_total{app=~\".*\",region=~\".*\",host=~\".*\"})"
          },
          {
            "disabled": false,
            "legend": "used",
            "name": "B",
            "query": "avg(fly_instance_memory_mem_total{app=~\".*\",region=~\".*\",host=~\".*\"}) - avg(fly_instance_memory_mem_free{app=~\".*\",region=~\".*\",host=~\".*\"})"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "Memory Usage",
      "yAxisUnit": "bytes"
    },
    {
      "id": "p_cpu",
      "isStacked": true,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_cpu",
        "promql": [
          {
            "disabled": false,
            "legend": "busy",
            "name": "A",
            "query": "sum(irate(fly_instance_cpu{mode=\"system\",app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) * 100"
          },
          {
            "disabled": false,
            "legend": "user",
            "name": "B",
            "query": "sum(irate(fly_instance_cpu{mode=\"user\",app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) * 100"
          },
          {
            "disabled": false,
            "legend": "iowait",
            "name": "C",
            "query": "sum(irate(fly_instance_cpu{mode=\"iowait\",app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) * 100"
          },
          {
            "disabled": false,
            "legend": "irqs",
            "name": "D",
            "query": "sum(irate(fly_instance_cpu{mode=~\".*irq\",app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) * 100"
          },
          {
            "disabled": false,
            "legend": "other",
            "name": "E",
            "query": "sum(irate(fly_instance_cpu{mode!=\"idle\",mode!=\"user\",mode!=\"system\",mode!=\"iowait\",mode!=\"irq\",mode!=\"softirq\",app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) * 100"
          },
          {
            "disabled": false,
            "legend": "idle",
            "name": "F",
            "query": "sum(irate(fly_instance_cpu{mode=\"idle\",app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) * 100"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "CPU Time (percent breakdown)",
      "yAxisUnit": "percent"
    },
    {
      "id": "p_tcp_e_c",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_tcp_e_c",
        "promql": [
          {
            "disabled": false,
            "legend": "connections",
            "name": "A",
            "query": "sum(rate(fly_edge_tcp_connects_count{app=~\".*\",region=~\".*\",host=~\".*\"}[5m]))"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "Edge connections per second",
      "yAxisUnit": "none"
    },
    {
      "id": "p_tcp_a_c",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_tcp_a_c",
        "promql": [
          {
            "disabled": false,
            "legend": "connections",
            "name": "A",
            "query": "sum(rate(fly_app_tcp_connects_count{app=~\".*\",region=~\".*\",host=~\".*\"}[5m]))"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "App connections per second",
      "yAxisUnit": "none"
    },
    {
      "id": "p_tcp_e_d",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_tcp_e_d",
        "promql": [
          {
            "disabled": false,
            "legend": "disconnections",
            "name": "A",
            "query": "sum(rate(fly_edge_tcp_disconnects_count{app=~\".*\",region=~\".*\",host=~\".*\"}[5m]))"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "Edge disconnections per second",
      "yAxisUnit": "none"
    },
    {
      "id": "p_tcp_a_d",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_tcp_a_d",
        "promql": [
          {
            "disabled": false,
            "legend": "disconnections",
            "name": "A",
            "query": "sum(rate(fly_app_tcp_disconnects_count{app=~\".*\",region=~\".*\",host=~\".*\"}[5m]))"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "App disconnections per second",
      "yAxisUnit": "none"
    },
    {
      "id": "p_http_rps",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_http_rps",
        "promql": [
          {
            "disabled": false,
            "legend": "{{status}}",
            "name": "A",
            "query": "sum(rate(fly_edge_http_responses_count{app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) by (status)"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "Edge Responses Per Second (by status)",
      "yAxisUnit": "none"
    },
    {
      "id": "p_http_edge_heat",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "heatmap",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_http_edge_heat",
        "promql": [
          {
            "disabled": false,
            "legend": "le={{le}}",
            "name": "A",
            "query": "sum(increase(fly_edge_http_response_time_seconds_bucket{app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) by (le)"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "Edge Response Times (bucketed)",
      "yAxisUnit": "seconds"
    },
    {
      "id": "p_http_app_heat",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "heatmap",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_http_app_heat",
        "promql": [
          {
            "disabled": false,
            "legend": "le={{le}}",
            "name": "A",
            "query": "sum(increase(fly_app_http_response_time_seconds_bucket{app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) by (le) > 0"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "App Response Times (bucketed)",
      "yAxisUnit": "seconds"
    },
    {
      "id": "p_tls_hs_heat",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "heatmap",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_tls_hs_heat",
        "promql": [
          {
            "disabled": false,
            "legend": "le={{le}}",
            "name": "A",
            "query": "sum(increase(fly_edge_tls_handshake_time_seconds_bucket{app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) by (le)"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "TLS Handshake times (bucketed)",
      "yAxisUnit": "seconds"
    },
    {
      "id": "p_tls_hsps",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_tls_hsps",
        "promql": [
          {
            "disabled": false,
            "legend": "handshakes/s",
            "name": "A",
            "query": "sum(rate(fly_edge_tls_handshake_time_seconds_count{app=~\".*\",region=~\".*\",host=~\".*\"}[5m]))"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "TLS Handshakes per second",
      "yAxisUnit": "none"
    },
    {
      "id": "p_tls_q_heat",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "heatmap",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_tls_q_heat",
        "promql": [
          {
            "disabled": false,
            "legend": "le={{le}}",
            "name": "A",
            "query": "sum(increase(fly_edge_tls_queue_time_seconds_bucket{app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) by (le) > 0"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "TLS Handshake queue times (bucketed)",
      "yAxisUnit": "seconds"
    },
    {
      "id": "p_tls_err",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_tls_err",
        "promql": [
          {
            "disabled": false,
            "legend": "{{servername}}",
            "name": "A",
            "query": "sum(increase(fly_edge_tls_handshake_errors{app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) by (servername) > 0"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "TLS Handshake errors (increase)",
      "yAxisUnit": "none"
    },
    {
      "id": "p_tls_sni",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_tls_sni",
        "promql": [
          {
            "disabled": false,
            "legend": "{{servername}}",
            "name": "A",
            "query": "sum(increase(fly_edge_tls_sni_limit_reached_count{app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) by (servername) > 0"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "TLS SNI limit reached",
      "yAxisUnit": "none"
    },
    {
      "id": "p_tls_ip",
      "isStacked": false,
      "nullZeroValues": "zero",
      "opacity": "1",
      "panelTypes": "graph",
      "query": {
        "builder": {
          "queryData": [],
          "queryFormulas": []
        },
        "clickhouse_sql": [
          {
            "disabled": true,
            "legend": "",
            "name": "A",
            "query": ""
          }
        ],
        "id": "q_tls_ip",
        "promql": [
          {
            "disabled": false,
            "legend": "{{ip}}",
            "name": "A",
            "query": "sum(increase(fly_edge_tls_ip_limit_reached_count{app=~\".*\",region=~\".*\",host=~\".*\"}[5m])) by (ip) > 0"
          }
        ],
        "queryType": "promql"
      },
      "timePreferance": "GLOBAL_TIME",
      "title": "TLS IP limit reached",
      "yAxisUnit": "none"
    }
  ],
  "uuid": "01998cd6-5619-7e7f-a3a0-02fdda5fa976"
}
